import{cT as e,r as t,A as a,t as n,u as i,j as s,aM as r,a7 as o,aF as l,ai as d,aI as c,v as m,i as h,l as u}from"./index-52b3c3fe.js";import{o as x,P as p,a as j,b as k,d as y,T as f}from"./entity-e87afc08.js";import{s as g,u as w}from"./shareService-62e8d7d4.js";import{S as v}from"./ShareModal-72700a85.js";import{C}from"./CheckOutlined-e689fa35.js";import{T as N,E as I}from"./index-56afb447.js";import{F as S}from"./index-2893e9ff.js";import{R as q,C as L}from"./row-63b2304c.js";import{D as b}from"./DeleteOutlined-5708e1b2.js";import"./Pagination-96703dea.js";import"./index-cbfea303.js";import"./index-38382bd5.js";const z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"};var T=function(e,i){return t.createElement(a,n({},e,{ref:i,icon:z}))};
/**![robot](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTMwMCAzMjhhNjAgNjAgMCAxMDEyMCAwIDYwIDYwIDAgMTAtMTIwIDB6TTg1MiA2NEgxNzJjLTE3LjcgMC0zMiAxNC4zLTMyIDMydjY2MGMwIDE3LjcgMTQuMyAzMiAzMiAzMmg2ODBjMTcuNyAwIDMyLTE0LjMgMzItMzJWOTZjMC0xNy43LTE0LjMtMzItMzItMzJ6bS0zMiA2NjBIMjA0VjEyOGg2MTZ2NTk2ek02MDQgMzI4YTYwIDYwIDAgMTAxMjAgMCA2MCA2MCAwIDEwLTEyMCAwem0yNTAuMiA1NTZIMTY5LjhjLTE2LjUgMC0yOS44IDE0LjMtMjkuOCAzMnYzNmMwIDQuNCAzLjMgOCA3LjQgOGg3MjkuMWM0LjEgMCA3LjQtMy42IDcuNC04di0zNmMuMS0xNy43LTEzLjItMzItMjkuNy0zMnpNNjY0IDUwOEgzNjBjLTQuNCAwLTggMy42LTggOHY2MGMwIDQuNCAzLjYgOCA4IDhoMzA0YzQuNCAwIDgtMy42IDgtOHYtNjBjMC00LjQtMy42LTgtOC04eiIgLz48L3N2Zz4=) */const M=t.forwardRef(T);function F(){const{t:a}=i(),n=[{key:"email",title:a("token.email"),dataIndex:["account","email"],width:120,render:e=>s.jsx(r,{value:e,onClick:t=>x(e,a,t),readOnly:!0})},{key:"uniqueName",title:"Unique Name",dataIndex:"uniqueName",align:"center",width:120},{key:"password",title:a("token.password"),dataIndex:"password",align:"center",width:120},{key:"gpt35Limit",title:a("token.gpt35Limit"),dataIndex:"gpt35Limit",align:"center",width:120,render:e=>-1==e?"无限制":e},{key:"gpt4Limit",title:a("token.gpt4Limit"),dataIndex:"gpt4Limit",align:"center",width:120,render:e=>-1==e?"无限制":e},{key:"refreshEveryday",title:a("token.refreshEveryday"),dataIndex:"refreshEveryday",align:"center",width:120,render:e=>e?s.jsx(C,{}):s.jsx(o,{})},{key:"temporaryChat",title:a("token.temporaryChat"),dataIndex:"temporaryChat",align:"center",width:80,render:e=>e?s.jsx(C,{}):s.jsx(o,{})},{key:"expiresAt",title:a("token.expiresAt"),dataIndex:"expiresAt",align:"center",width:120,render:e=>""==e?"未知":e},{key:"shareToken",title:"Share Token",dataIndex:"shareToken",align:"center",width:120,render:e=>s.jsx(r,{value:e,onClick:t=>x(e,a,t),readOnly:!0})},{key:"comment",title:a("token.comment"),dataIndex:"comment",align:"center",render:e=>s.jsx(N.Text,{style:{maxWidth:500},ellipsis:!0,children:e})},{title:a("token.action"),key:"operation",align:"center",render:(e,t)=>s.jsxs(l.Group,{children:[s.jsx(d,{title:"登录并跳转至对话",placement:"bottom",children:s.jsx(l,{icon:s.jsx(M,{}),type:"primary",onClick:()=>B(t)})}),s.jsx(l,{icon:s.jsx(I,{}),type:"primary",onClick:()=>_(t)}),s.jsx(p,{title:a("token.deleteConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>J(t),children:s.jsx(l,{icon:s.jsx(b,{}),type:"primary",loading:P==t.accountId+t.uniqueName,danger:!0})})]})}],z=["uniqueName","gpt4Limit","expiresAt","comment","operation"],T=n.map((e=>e.key)),F=j(),E=k(),[O,A]=t.useState(!1),V=function(){const[a]=e();return t.useMemo((()=>a),[a])}(),[H]=S.useForm(),K=S.useWatch("email",H),W=S.useWatch("uniqueName",H),[D,G]=t.useState(z),[P,R]=t.useState(void 0),[U,Y]=t.useState({formValue:{...y},title:a("token.edit"),show:!1,onOk:e=>{Y((e=>({...e,show:!1})))},onCancel:()=>{Y((e=>({...e,show:!1})))}});t.useEffect((()=>{H.setFieldValue("email",V.get("email"))}),[V]);const _=e=>{Y({formValue:e,title:a("token.edit"),show:!0,onOk:(e,t)=>{E.mutate(e,{onSuccess:()=>{Y((e=>({...e,show:!1})))},onSettled:()=>t(!1)})},onCancel:()=>{Y((e=>({...e,show:!1})))}})},B=e=>{A(!0),c.info({content:"正在跳转至对话...",key:"chatLogin",duration:5}),g.chatLoginShare(e.uniqueName,e.password).then((e=>{e&&window.open(e,"_blank")})).finally((()=>{A(!1)}))},J=e=>{R(e.accountId+e.uniqueName),F.mutate(e,{onSettled:()=>{R(void 0)}})},{data:X}=w({queryKey:["shareList",K,W],queryFn:()=>g.searchShare(K,W)}),Z=n.map((e=>({...e,hidden:!D.includes(e.key)})));return s.jsxs(m,{direction:"vertical",size:"large",className:"w-full",children:[s.jsx(h,{children:s.jsx(S,{form:H,children:s.jsxs(q,{gutter:[16,16],children:[s.jsx(L,{span:6,lg:6,children:s.jsx(S.Item,{label:a("token.email"),name:"email",className:"!mb-0",children:s.jsx(r,{})})}),s.jsx(L,{span:6,lg:6,children:s.jsx(S.Item,{label:"Unique Name",name:"uniqueName",className:"!mb-0",children:s.jsx(r,{})})}),s.jsx(L,{span:12,lg:12,children:s.jsxs("div",{className:"flex justify-end",children:[s.jsx(l,{onClick:()=>{H.resetFields()},children:a("token.reset")}),s.jsx(l,{type:"primary",className:"ml-4",onClick:()=>{H.validateFields().then((e=>{H.submit()}))},children:a("token.search")})]})})]})})}),s.jsx(h,{title:a("token.shareList"),extra:s.jsx(u,{title:"abc",defaultChecked:!0,checkedChildren:"简洁",unCheckedChildren:"详细",onChange:e=>{G(e?[...z]:[...T])}}),children:s.jsx(f,{rowKey:e=>e.accountId+e.uniqueName,size:"small",scroll:{x:"max-content"},pagination:{pageSize:10},columns:Z,dataSource:X,loading:O})}),s.jsx(v,{...U})]})}export{F as default};
