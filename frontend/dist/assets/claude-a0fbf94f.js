import{u as e,bZ as s,r as t,j as a,aM as o,c1 as i,aF as n,c2 as r,v as l,i as c}from"./index-f7ab5e13.js";import{u as d,d as m,o as h,P as u,T as x}from"./entity-5338cde5.js";import{u as j,a as p,b as y,c as f,C as k,E as w,B as S,S as g,d as C}from"./accountStore-d0ec45c3.js";import{S as T}from"./ShareModal-f5cba2b8.js";import{AccountModal as N}from"./AccountModal-35511e0d.js";import{F as K}from"./index-49b42c3a.js";import{T as I,E as v}from"./index-8e537eef.js";import{u as O}from"./shareService-42d4394b.js";import{R as V,C as F}from"./row-5814c07b.js";import{R as L}from"./ReloadOutlined-265d71c8.js";import{D as b}from"./DeleteOutlined-81f211ef.js";import"./Pagination-73d267c3.js";import"./index-46accfe0.js";import"./CheckOutlined-cb1ec32b.js";import"./index-f2019e83.js";function z(){const[z]=K.useForm(),{t:M}=e(),_=j(),E=p(),G=y(),R=f(),W=d(),q=s(),[A,D]=t.useState(-1),[P,Y]=t.useState(-1),Z=K.useWatch("email",z),[$,B]=t.useState({formValue:{email:"",accountType:"claude",password:"",refreshToken:""},title:"New",show:!1,onOk:(e,s)=>{e.id?E.mutate(e,{onSuccess:()=>{B((e=>({...e,show:!1})))},onSettled:()=>s(!1)}):_.mutate(e,{onSuccess:()=>{B((e=>({...e,show:!1})))},onSettled:()=>s(!1)})},onCancel:()=>{B((e=>({...e,show:!1})))}}),[H,J]=t.useState({formValue:{...m,shareType:"claude"},title:"New",show:!1,onOk:(e,s)=>{s(!0),W.mutate(e,{onSuccess:()=>{J((e=>({...e,show:!1})))},onSettled:()=>{s(!1)}})},onCancel:()=>{J((e=>({...e,show:!1})))}}),Q=[{title:M("token.email"),dataIndex:"email",ellipsis:!0,align:"center",render:e=>a.jsx(I.Text,{style:{maxWidth:200},ellipsis:!0,children:e})},{title:M("token.password"),dataIndex:"password",align:"center",ellipsis:!0,render:e=>a.jsx(I.Text,{style:{maxWidth:200},ellipsis:!0,children:e})},{title:"Session Key",dataIndex:"sessionKey",align:"center",width:150,render:(e,s)=>s.sessionKey?a.jsx(o,{value:s.sessionKey,onClick:e=>h(s.sessionKey,M,e),readOnly:!0}):a.jsx(i,{color:"error",children:"Empty"})},{title:M("token.shareStatus"),dataIndex:"shared",align:"center",width:100,render:(e,s)=>1==s.shared?a.jsx(k,{twoToneColor:"#52c41a"}):a.jsx(w,{twoToneColor:"#fa8c16"})},{title:M("token.updateTime"),dataIndex:"updateTime",align:"center",width:200},{title:M("token.share"),key:"share",align:"center",render:(e,s)=>a.jsxs(n.Group,{children:[a.jsx(S,{count:s.shareList?.length,style:{zIndex:9},children:a.jsx(n,{icon:a.jsx(g,{}),onClick:()=>q({pathname:"/token/share/claude",search:`?email=${s.email}`}),children:M("token.shareList")})}),a.jsx(n,{icon:a.jsx(r,{}),onClick:()=>X(s)})]})},{title:M("token.action"),key:"operation",align:"center",render:(e,s)=>a.jsxs(n.Group,{children:[a.jsx(u,{title:M("common.refreshConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>{Y(s.id),R.mutate(s.id,{onSettled:()=>Y(void 0)})},children:a.jsx(n,{icon:a.jsx(L,{}),type:"primary",loading:P===s.id,children:M("common.refresh")},s.id)}),a.jsx(n,{onClick:()=>ee(s),icon:a.jsx(v,{}),type:"primary"}),a.jsx(u,{title:M("common.deleteConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>{D(s.id),G.mutate(s.id,{onSuccess:()=>D(void 0)})},children:a.jsx(n,{icon:a.jsx(b,{}),type:"primary",loading:A===s.id,danger:!0})})]})}],{data:U}=O({queryKey:["accounts","claude",Z],queryFn:()=>C.searchAccountList(Z,"claude")}),X=e=>{J((s=>({...s,show:!0,title:M("token.share"),formValue:{...m,accountId:e.id,shareType:"claude"}})))},ee=e=>{B((s=>({...s,show:!0,title:M("token.edit"),formValue:{...s.formValue,id:e.id,email:e.email,password:e.password,shared:e.shared,sessionKey:e.sessionKey}})))};return a.jsxs(l,{direction:"vertical",size:"large",className:"w-full",children:[a.jsx(c,{children:a.jsx(K,{form:z,children:a.jsxs(V,{gutter:[16,16],children:[a.jsx(F,{span:6,lg:6,children:a.jsx(K.Item,{label:M("token.email"),name:"email",className:"!mb-0",children:a.jsx(o,{})})}),a.jsx(F,{span:18,lg:18,children:a.jsxs("div",{className:"flex justify-end",children:[a.jsx(n,{onClick:()=>{z.resetFields()},children:M("token.reset")}),a.jsx(n,{type:"primary",className:"ml-4",children:M("token.search")})]})})]})})}),a.jsx(c,{title:M("token.accountList"),extra:a.jsx(l,{children:a.jsx(n,{type:"primary",onClick:()=>{B((e=>({...e,show:!0,title:M("token.createNew"),formValue:{id:void 0,email:"",password:"",sessionKey:"",accountType:"claude",shared:0,custom_type:"refresh_token",custom_token:""}})))},children:M("token.createNew")})}),children:a.jsx(x,{rowKey:"id",size:"small",scroll:{x:"max-content"},pagination:{pageSize:10},columns:Q,dataSource:U})}),a.jsx(N,{...$}),a.jsx(T,{...H})]})}export{z as default};
